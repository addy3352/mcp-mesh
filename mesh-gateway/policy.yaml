services:
  mesh-core:   { url: http://mesh-core:8091 }
  garmin:      { url: http://mcp-garmin:8000 }
  nutrition:   { url: http://mcp-nutrition:8003 }
  linkedin:    { url: http://mcp-linkedin:8005 }
  portal:      { url: http://mcp-portal:8007 }
  agent-health: { url: http://mcp-agent-health:8008 }

roles:
  chatgpt-agent:  # Only logs meals into mesh
    allow_tools:
      - nutrition.write_meal
      - nutrition.get_daily_summary
      - nutrition.list_meals
      - garmin.sync # TEMPORARY FOR TESTING
    deny_tools:
      - linkedin.create_post
      - garmin.*
      - agent-health.*
      - portal.update_health_panel

  agent-iris:     # posts to LinkedIn only
    allow_tools:
      - linkedin.create_post
    deny_tools:
      - nutrition.*
      - garmin.*
      - agent-health.*
      - portal.update_health_panel

  agent-health:   # Health reasoning agent
    allow_tools:
      # Garmin reads
      - garmin.get_stats
      - garmin.get_heart_rates
      - garmin.get_sleep_data
      - garmin.get_all_day_stress
      - garmin.get_hrv_data
      - garmin.get_activities_range
      - mesh-core.core_get_health_summary      
      # Nutrition reads
      - nutrition.get_daily_summary
      
      # Health DB writes
      - agent-health.save_recommendation
      - agent-health.get_ai_recommendation
      - agent-health.notify_health
      
      # Sync triggers
      - agent-health.trigger_manual_sync

      # UI update
      - portal.update_health_panel

    deny_tools:
      - nutrition.write_meal
      - linkedin.*

  portal-agent:
    allow_tools:
      - nutrition.get_daily_summary # For /mesh/calories/latest and /mesh/weight/latest
      - agent-health.get_ai_recommendation # For /mesh/ai/recommendation
      - garmin.sync # For /mesh/sync/garmin
      - nutrition.sync # For /mesh/sync/nutrition
      - nutrition.list_meals
      - portal.get_user_metrics
      - mesh-core.core_get_health_summary     
    deny_tools:
      - linkedin.create_post
      - chatgpt.*
      - agent-health.save_recommendation  